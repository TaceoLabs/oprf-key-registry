// SPDX-License-Identifier: MIT
pragma solidity ^0.8.20;

import {BabyJubJub} from "../src/BabyJubJub.sol";
import {OprfKeyGen} from "../src/OprfKeyGen.sol";

library Contributions {
    uint256 public constant SHOULD_OPRF_PUBLIC_KEY_X =
        20175149554334436665718029715058635395342185581569788809938983225641032671468;
    uint256 public constant SHOULD_OPRF_PUBLIC_KEY_Y =
        20160080761873917790635687189022917878045574417213270279490858057316131731581;

    uint256 public constant LAGRANGE_RESHARE1_0 = 2;
    uint256 public constant LAGRANGE_RESHARE1_1 =
        2736030358979909402780800718157159386076813972158567259200215660948447373040;

    uint256 public constant LAGRANGE_RESHARE2_0 = 3;
    uint256 public constant LAGRANGE_RESHARE2_1 =
        2736030358979909402780800718157159386076813972158567259200215660948447373039;

    function aliceKeyGenRound1Contribution() internal pure returns (OprfKeyGen.Round1Contribution memory) {
        return OprfKeyGen.Round1Contribution({
            commShare: BabyJubJub.Affine({
                x: 9731396402574735292520607435652929479013799369660600452718124765962384122206,
                y: 1791183065767254290031487023641029869749363832550048702108440921874888860067
            }),
            commCoeffs: 8496708630022317646575928536550768571845188951999730040576046289640745397332,
            ephPubKey: BabyJubJub.Affine({
                x: 12821603125475748520011037468870418930812538699668722876863355416717947078760,
                y: 17067928114558614218231702459319414114121381971449529647004646393893219524072
            })
        });
    }

    function bobKeyGenRound1Contribution() internal pure returns (OprfKeyGen.Round1Contribution memory) {
        return OprfKeyGen.Round1Contribution({
            commShare: BabyJubJub.Affine({
                x: 1688152706970503579483116674764161908712002477111907598715160302455660303671,
                y: 20413269805955861205216587925478893435677791255572561712193586073128762510903
            }),
            commCoeffs: 1619115747684702249594160475802698736138219914756231397884440866509282812835,
            ephPubKey: BabyJubJub.Affine({
                x: 17890497755544838533098087106402431639067325815921088381978921355094546522674,
                y: 20342512809943392979839633216403962703715154732193220187900007725777935127193
            })
        });
    }

    function carolKeyGenRound1Contribution() internal pure returns (OprfKeyGen.Round1Contribution memory) {
        return OprfKeyGen.Round1Contribution({
            commShare: BabyJubJub.Affine({
                x: 181606117961119882406004099351368673462695832980672617028988734026223981902,
                y: 16711318399047418081809052707903382106816693867662676821566699591386252462603
            }),
            commCoeffs: 19432128289035819244224786947487326898050652353970836438633529067698186914178,
            ephPubKey: BabyJubJub.Affine({
                x: 13073144041725328335228124592823902747732340334382570899400898379558572799738,
                y: 15586179167309032888675866273648873473284815630818187443186664812911365381093
            })
        });
    }

    function aliceKeyGenRound2Contribution() internal pure returns (OprfKeyGen.Round2Contribution memory) {
        OprfKeyGen.SecretGenCiphertext[] memory ciphers = new OprfKeyGen.SecretGenCiphertext[](3);
        ciphers[0].cipher = 19832253897649054271583161487919613448418129890226907506566329446364699806012;
        ciphers[0].nonce = 20831482850960414231183839105821258227003798184995960515894249198692735666323;
        ciphers[0].commitment = BabyJubJub.Affine({
            x: 20513272875461065240284836886906756366297412237401803986538750732396513323238,
            y: 11317169030108300678276152129610412775719958981625328310927604721501577650769
        });

        ciphers[1].cipher = 21430231675243257185198468378862610779956271988348572262035625373534800152720;
        ciphers[1].nonce = 2003172888822673530961444113359455648790598765659940525099509499811060041048;
        ciphers[1].commitment = BabyJubJub.Affine({
            x: 13562773859964920067722882885155965035224819181864324189837932089483606083033,
            y: 9439023010529421386242582227721957059415260426108089560616967843968186936626
        });

        ciphers[2].cipher = 16461230742255562911886249969828105674851381659661732414548377757735444042086;
        ciphers[2].nonce = 9727524650535554873543745948120291269690544605607791517682543526871232295281;
        ciphers[2].commitment = BabyJubJub.Affine({
            x: 9799955200655642794486490592711590478616946916469870430231903193256814871292,
            y: 7910519810599925421969300274277074072370335395203109552793024777356644374799
        });

        return OprfKeyGen.Round2Contribution({
            compressedProof: [
                7489273648609502992983484140998083615357692735581216280538892353105930259040,
                19989437463538379781198550556176091384238467414813133415903411168177793686171,
                29693571288687398378228689123836192363278067577157154896901141959110697392409,
                10614139838669976210676155075096864413499287650952393555135097683677168314614
            ],
            ciphers: ciphers
        });
    }

    function bobKeyGenRound2Contribution() internal pure returns (OprfKeyGen.Round2Contribution memory) {
        OprfKeyGen.SecretGenCiphertext[] memory ciphers = new OprfKeyGen.SecretGenCiphertext[](3);
        ciphers[0].cipher = 18249384055506802041537124767751613342781214525932159399360031773007369623669;
        ciphers[0].nonce = 6394203220878853146824375105870234150928064079939148335565206383036391193698;
        ciphers[0].commitment = BabyJubJub.Affine({
            x: 15168931539227738681858662049949102379559570572029998980245762566492408139845,
            y: 1087156765005069731279702195851276669087562166285823949178025092634118225123
        });

        ciphers[1].cipher = 8929682973629635905975444121732984188169048861284454847066106131490275645077;
        ciphers[1].nonce = 14527946513992279612568796977832998354432028981067861133373552979590107767388;
        ciphers[1].commitment = BabyJubJub.Affine({
            x: 18380317518585944418704282407669892533658702105637715468579634349787732885700,
            y: 12286307611807816504249204782796683408997557366439925173453984746857693507180
        });

        ciphers[2].cipher = 5748583154151364756931693680531995016789959544985130320909209756871724319088;
        ciphers[2].nonce = 16429939821405921803667838139941024849250518763325424176544002370913590371;
        ciphers[2].commitment = BabyJubJub.Affine({
            x: 11504491929734075362189835383491574655078020737387790289445068396046908410950,
            y: 4429285008952165989321392573059998840101366699515723312607938939382895376563
        });

        return OprfKeyGen.Round2Contribution({
            compressedProof: [
                37110928150208282832357970659795761746468531810156791258398565288740928207745,
                12341293030608599642694259226976466687712122680341499000989003999397523166146,
                45027821971387008843653558588067845492439021977212575506915807657071819590771,
                37370535234935536983070649241901980017772437301871053080882352856332868622160
            ],
            ciphers: ciphers
        });
    }

    function carolKeyGenRound2Contribution() internal pure returns (OprfKeyGen.Round2Contribution memory) {
        OprfKeyGen.SecretGenCiphertext[] memory ciphers = new OprfKeyGen.SecretGenCiphertext[](3);
        ciphers[0].cipher = 1957877434559298822431197687001099087163743200380549416753783113443494861049;
        ciphers[0].nonce = 11563240921388312598140474743536214562840620425550760487143605407144119028822;
        ciphers[0].commitment = BabyJubJub.Affine({
            x: 7875643394365688292127963684738244301283489208282219953394203607763489342338,
            y: 3076084391401115370385119862751914643783017956084129539987526492016422004905
        });

        ciphers[1].cipher = 6812436883111903466134033216484415754279983706313865124202613723085049452555;
        ciphers[1].nonce = 5554328351463732810108701478562342533557702235545594287647140294419337032318;
        ciphers[1].commitment = BabyJubJub.Affine({
            x: 14658070541406441628993893598625145140395573534629484999868433896255596962882,
            y: 4677506342044906785586295913622023065412241899821925941762293572184091942278
        });

        ciphers[2].cipher = 12640227978333213706662593448580980057303829911786861092568198549583654956758;
        ciphers[2].nonce = 21835195016176496961373164377549583153790030974974200949166898594281294265923;
        ciphers[2].commitment = BabyJubJub.Affine({
            x: 15166950756287433523984995335844635007997670138718431257249065022332098348119,
            y: 20942165173003147834228711951197376959391222901305016500501111566993829324338
        });

        return OprfKeyGen.Round2Contribution({
            compressedProof: [
                11524286503299032699812598979075934123390547754029109791477223759973860441304,
                1972717075150534148169497022594623597438969348452718557873856399510334800267,
                12651596385682504462440812990434899846799897711521453661647581098687159556576,
                18519511475938037274140264458113729712696336098920190934409073840830345157938
            ],
            ciphers: ciphers
        });
    }

    function aliceReshare1Round1Contribution() internal pure returns (OprfKeyGen.Round1Contribution memory) {
        return OprfKeyGen.Round1Contribution({
            commShare: BabyJubJub.Affine({
                x: 16062973116794081552712593805136955167636714564622881915511609596962351864823,
                y: 6557380504997132377914921663934948972609177413029769204458212633090197846589
            }),
            commCoeffs: 11421317339431238769502691094381747036365553997747905896317479995808791813331,
            ephPubKey: BabyJubJub.Affine({
                x: 5526635267201549399717600629221571853865217909016895042950306347685274302659,
                y: 9160340034192672224739870891503283358361278179490387109201378738995434122220
            })
        });
    }

    function bobReshare1Round1Contribution() internal pure returns (OprfKeyGen.Round1Contribution memory) {
        return OprfKeyGen.Round1Contribution({
            commShare: BabyJubJub.Affine({
                x: 91176233636677954556161430483828463443608212229589478345618270997193150880,
                y: 2559000961455833025613949648281423815794770568094314541441430835225000249695
            }),
            commCoeffs: 2967675016655705409237092457628216345945183182228126400164225864103828911354,
            ephPubKey: BabyJubJub.Affine({
                x: 5145818224817658916896306857067357700748001689173806714055045926286258672722,
                y: 88626495828518717369278175062615125708153929656615097440316927130544574835
            })
        });
    }

    function carolReshare1Round1Contribution() internal pure returns (OprfKeyGen.Round1Contribution memory) {
        return OprfKeyGen.Round1Contribution({
            commShare: BabyJubJub.Affine({x: 0, y: 0}),
            commCoeffs: 0,
            ephPubKey: BabyJubJub.Affine({
                x: 10428388370197218569623973156154329565281374110216644891374719941926225856948,
                y: 4104446463252517966911417464610033819854641522048092574725287831073248688574
            })
        });
    }

    function aliceReshare1Round2Contribution() internal pure returns (OprfKeyGen.Round2Contribution memory) {
        OprfKeyGen.SecretGenCiphertext[] memory ciphers = new OprfKeyGen.SecretGenCiphertext[](3);
        ciphers[0].cipher = 197118226231109495478452990381235518764414053856124898397996429629727947636;
        ciphers[0].nonce = 5407597092397282724048949558614821167540243075109267536112961438456719199198;
        ciphers[0].commitment = BabyJubJub.Affine({
            x: 2517140618802323935990188126356463308284820068504690900385174931749022874171,
            y: 19938711859143348457219834581523694170592961220073331905006232206289205218017
        });

        ciphers[1].cipher = 7948828348498557027462154988238880740626786311618856505083077135119901329671;
        ciphers[1].nonce = 8717921804973093009329807717663849887535055887502915159480948371932999605990;
        ciphers[1].commitment = BabyJubJub.Affine({
            x: 574395250142925365470385864584460634039199074850330540451879312660116630666,
            y: 13099709848479778199136362924176241112310955054991690080933195048447270371895
        });

        ciphers[2].cipher = 19750170834609435505445539586671495413405777227016463039784090437093637154172;
        ciphers[2].nonce = 1687192898215333523454595518697859066609133187741328227130761086708423358650;
        ciphers[2].commitment = BabyJubJub.Affine({
            x: 12842180747404185582575623232617050812546768593217046607537822740022966684784,
            y: 8799663124595542098655179011735134947406036819787716536249378063315037891822
        });

        return OprfKeyGen.Round2Contribution({
            compressedProof: [
                10030310196777558425968873099444119875562865006018210377002236891957043075646,
                217268790479166039895399603567864901371900204400831025280028486328600474866,
                43790148029313963323854964933553496647424318116580718391419750118688462084758,
                3995639805663536866949429127332580717437956081353008889247084271215137015329
            ],
            ciphers: ciphers
        });
    }

    function bobReshare1Round2Contribution() internal pure returns (OprfKeyGen.Round2Contribution memory) {
        OprfKeyGen.SecretGenCiphertext[] memory ciphers = new OprfKeyGen.SecretGenCiphertext[](3);
        ciphers[0].cipher = 9407708232847761869067255315123502922618526742106679830299918011175881010762;
        ciphers[0].nonce = 8520772281149716841234555527563291790077333312018724191165268773825445386313;
        ciphers[0].commitment = BabyJubJub.Affine({
            x: 21849289599796825914810608907099803181089186052475617337701172340249216988345,
            y: 4704248852230145430204216421416704293888775169122454537216819790830317061511
        });

        ciphers[1].cipher = 10823800239324393495646880604636919132735050971332234227599387217889714518005;
        ciphers[1].nonce = 1439976796987079407563762955639780055561111741484432921715349883801366094771;
        ciphers[1].commitment = BabyJubJub.Affine({
            x: 13046093563746847983323077643432947218634675018972550009794903775414610236039,
            y: 11502353214267372835313537343111932434184610101182205368666459948784964525072
        });

        ciphers[2].cipher = 4259655725640736635190922534948154303425729534975924006212543995823880315662;
        ciphers[2].nonce = 7448961735312494728554206562665638521831089664715615924093610953376392895616;
        ciphers[2].commitment = BabyJubJub.Affine({
            x: 19283574813997214806272551162647080898537390330977104917161235189359733356659,
            y: 10053094708537105921220495201632455602974820941840745641675361612110329734306
        });

        return OprfKeyGen.Round2Contribution({
            compressedProof: [
                39568600564593259585691055526745423541218153312409713934520156912320555360167,
                7158985856332895447846061197341888840319337513240609274440056182792360018662,
                28779065945800730690830898537079325870964987039317333815015499014875785494492,
                9246381799099336125704648166441980292790313462528067788744414354241045116962
            ],
            ciphers: ciphers
        });
    }

    function aliceReshare2Round1Contribution() internal pure returns (OprfKeyGen.Round1Contribution memory) {
        return OprfKeyGen.Round1Contribution({
            commShare: BabyJubJub.Affine({x: 0, y: 0}),
            commCoeffs: 0,
            ephPubKey: BabyJubJub.Affine({
                x: 608123890088521772490855263666300717031709772778839696199735325114440296142,
                y: 7941538158018962761568053405639384519261979336315648861192784399646692505523
            })
        });
    }

    function bobReshare2Round1Contribution() internal pure returns (OprfKeyGen.Round1Contribution memory) {
        return OprfKeyGen.Round1Contribution({
            commShare: BabyJubJub.Affine({
                x: 5634149430531274028412898631829388172501915004209628780803130431026743077693,
                y: 13112181497848450299416598095804710559058919108017442094854378661759245199051
            }),
            commCoeffs: 10458727925807366630162936706277985076013587294979868962939318153112593033249,
            ephPubKey: BabyJubJub.Affine({
                x: 17426881268192685001757950137570142819948424801788097681002410900513948211627,
                y: 5866298680929634825003069132470254862962380329648465725069576346073537153896
            })
        });
    }

    function carolReshare2Round1Contribution() internal pure returns (OprfKeyGen.Round1Contribution memory) {
        return OprfKeyGen.Round1Contribution({
            commShare: BabyJubJub.Affine({
                x: 6475835016907173774429379067371133698036163375381327213245538425087441835089,
                y: 9841943748444410204166247325667369604063932122334491806171602956109037592242
            }),
            commCoeffs: 14997005071917105306252823299456862590412689918078258040610964576183275121936,
            ephPubKey: BabyJubJub.Affine({
                x: 19838349019452661935594326011872659279856964955523651722132311753940475647492,
                y: 2168679287993725153338949277191596308990094518400104703467229659436387027478
            })
        });
    }

    function bobReshare2Round2Contribution() internal pure returns (OprfKeyGen.Round2Contribution memory) {
        OprfKeyGen.SecretGenCiphertext[] memory ciphers = new OprfKeyGen.SecretGenCiphertext[](3);
        ciphers[0].cipher = 18816262879665877905949758478860723821530629732424032772127783216869764250509;
        ciphers[0].nonce = 3035994099000363148594624471527752695077648197263990958037871164075749137685;
        ciphers[0].commitment = BabyJubJub.Affine({
            x: 1380334253558993742689454317424221957931904663162238362069870103991206520773,
            y: 18890498091042656277730454291926625781513273287014358770478160633996863960583
        });

        ciphers[1].cipher = 10476604607103969390532924384545645531982893675558771549108699031198793082958;
        ciphers[1].nonce = 20873589538029612046158577037850164438683900369319440024456814809695235647353;
        ciphers[1].commitment = BabyJubJub.Affine({
            x: 6050184753119871116356943365644929676004819538353844473697889211522687594523,
            y: 2132177145321149789086926204684815618227448794417950983873206063110752930943
        });

        ciphers[2].cipher = 12058647575588442531610078170695460502324875444809673367879286544436036237627;
        ciphers[2].nonce = 15490921936326113112169923105119127795180414611165433504844587266367780599911;
        ciphers[2].commitment = BabyJubJub.Affine({
            x: 21701742143590018239815248026012559829542558571535762508534185391989295196906,
            y: 4678238268222438811238433085024233070402948484113478284750459655060752047798
        });

        return OprfKeyGen.Round2Contribution({
            compressedProof: [
                34634441233941053816066304439692405013114288935964132179073820483613007712511,
                10013929576087127672045330460089950406469871716763257856165247173233756317620,
                37948797296154420124503075476577214355679610671793678433979941472574041770834,
                40490489815220713650302697009846654550508408896726633805192976502071945355029
            ],
            ciphers: ciphers
        });
    }

    function carolReshare2Round2Contribution() internal pure returns (OprfKeyGen.Round2Contribution memory) {
        OprfKeyGen.SecretGenCiphertext[] memory ciphers = new OprfKeyGen.SecretGenCiphertext[](3);
        ciphers[0].cipher = 5563410267912572074767299418992296979280946642779029692169142406594865002117;
        ciphers[0].nonce = 2146667492274117512461943186184662459483433236128534376097435491207137149011;
        ciphers[0].commitment = BabyJubJub.Affine({
            x: 6110762653817702729226675590545833432211064319576235535471091178684221387628,
            y: 3942518847797254220202996148935869608837799520927070416661214648138608865191
        });

        ciphers[1].cipher = 5041596022574294874102917205069189010838716499228634982821786578098214451206;
        ciphers[1].nonce = 21583880709398529529208416979320878586141269379000706595995626176350562975378;
        ciphers[1].commitment = BabyJubJub.Affine({
            x: 1370672401594082383073458580242045090521033740458789628673682382369903257527,
            y: 2521498388936543310183158627546187839467157820067582566575066830053544599175
        });

        ciphers[2].cipher = 7123716286753875084671481545227964971832065827321878766061010032097423476045;
        ciphers[2].nonce = 16148549770334569312492478490502802485302032060637448791480197634489665292024;
        ciphers[2].commitment = BabyJubJub.Affine({
            x: 18451265273397224396907667554861161043545028440358236137598653248866403562911,
            y: 20012745051335990951436913928870900806054081199178035565043623297465988695809
        });

        return OprfKeyGen.Round2Contribution({
            compressedProof: [
                35310165663954027527959899016589579678687579509243645825934419324236038498087,
                4713409969044173197709349510522147209396287945309122029968240660225342159114,
                84569289622274736201950578790037501856582707246133478821158460393257913058492,
                40960592310510901752680116509378387287272191294326807914462804514295338883000
            ],
            ciphers: ciphers
        });
    }
}
